{"slots":{"0":{"name":"slot1","type":{"events":[],"methods":[]}},"1":{"name":"slot2","type":{"events":[],"methods":[]}},"2":{"name":"slot3","type":{"events":[],"methods":[]}},"3":{"name":"slot4","type":{"events":[],"methods":[]}},"4":{"name":"slot5","type":{"events":[],"methods":[]}},"5":{"name":"slot6","type":{"events":[],"methods":[]}},"6":{"name":"slot7","type":{"events":[],"methods":[]}},"7":{"name":"slot8","type":{"events":[],"methods":[]}},"8":{"name":"slot9","type":{"events":[],"methods":[]}},"9":{"name":"slot10","type":{"events":[],"methods":[]}},"-1":{"name":"unit","type":{"events":[],"methods":[]}},"-3":{"name":"player","type":{"events":[],"methods":[]}},"-2":{"name":"construct","type":{"events":[],"methods":[]}},"-4":{"name":"system","type":{"events":[],"methods":[]}},"-5":{"name":"library","type":{"events":[],"methods":[]}}},"handlers":[{"code":"-- don't edit\nmanager.activate()\nunit.stopTimer(\"on\")\n","filter":{"args":[{"value":"on"}],"signature":"onTimer(tag)","slotKey":"-1"},"key":"0"},{"code":"-- don't edit\nmanager.deactivate()\nmanager.deactivate() -- because one isn't enough sometimes\nmanager.deactivate() -- because one isn't enough sometimes","filter":{"args":[],"signature":"onStop()","slotKey":"-1"},"key":"1"},{"code":"-- https://github.com/squizzlabs/du-tiny-factory\n-- For the latest versions of pb and screen software, freely avialable.\n\nlocal items = {} -- don't modify this line\n\n--[[\nInstructions:\n\nto add an item, look it up by name on https://du-lua.dev/#/items\nand enter the value below as you see in the examples.\nLeft side is the item id, right side is the item quantity.\nThen turn this unit on!  The programming boards will work together to handle the rest\n\nWhen you change any of the item values, turn this unit off and \nthen back on for changes to take effect.\n]]\n\n-- items[2093838343] = 1 -- surrogate vr station m\n-- items[3667785070] = 1 -- surrogate pod station m\n-- items[819161541] = 1 -- modern screen l\n\n\n-- some example basic items for testing each assembly line\n--[[items[1727614690] = 1 -- wing xs\nitems[2532454166] = 1 -- wing s\nitems[404188468] = 1 -- wing m\nitems[2375915630] = 1 -- atmo engine l\n\n-- some example complicated items for testing your new Tiny Factory\nitems[286542481] = 1 -- emergency control unit xs\nitems[184261427] = 1 -- screen xs\nitems[1866437084] = 1 -- remote controller xs\nitems[3663249627] = 2 -- elevator xs]]\n\n\n-- some really complicated items!\nitems[774130122] = 1 -- maintenance unit xl\n-- items[2643443936] = 1 -- warp drive l\n\n\n--[[\nPLEASE NOTE!\n\nIf you're looking to produce fuels, honeycombs, warp cells, etc. the current\nconfiguration does not support this.  You can set this up manually, however, by \nremoving an assembler of your choice and replacing it with the proper industry.  Link this\nnew industry to the chef (top pb under the pedestal), link the two line hubs as inputs, and\nthe output as the output.  Be sure to restart the main board on top of the pedestal.\n]]\n\n\n-- don't modify the following\ndatabank_clear = false --global clear the databank next time this starts\nif databank_clear == true then databank.clear() end\n\ndatabank.setStringValue(\"orders\", serialize(items));\nmanager.deactivate()\nunit.setTimer(\"on\", 0.1)\n\nif screen then screen.activate() end\n\n","filter":{"args":[],"signature":"onStart()","slotKey":"-1"},"key":"2"},{"code":"for slot_name, slot in pairs(unit) do\n    if type(slot) == \"table\" and type(slot.export) == \"table\" and slot.getClass then\n        slotClass = slot.getClass():lower()\n        if slotClass == 'databankunit' then\n            databank = slot\n        elseif slotClass:sub(0,5) == \"screen\" then\n            screen = slot\n        elseif slotClass == \"manualswitchunit\" then\n            manager = slot\n        end\n    end\nend\n\n\nlocal concat = table.concat\nlocal sFormat=string.format\n\nlocal function internalSerialize(table, tC, t)\n    t[tC] = \"{\"\n    tC = tC + 1\n    if #table == 0 then\n        local hasValue = false\n        for key, value in pairs(table) do\n            hasValue = true\n            local keyType = type(key)\n            if keyType == \"string\" then\n                t[tC] = sFormat(\"[%q]=\", key)\n            elseif keyType == \"number\" then\n                t[tC] = \"[\" .. key .. \"]=\"\n            elseif keyType == \"boolean\" then\n                t[tC] = \"[\" .. tostring(key) .. \"]=\"\n            else\n                t[tC] = \"notsupported=\"\n            end\n            tC = tC + 1\n\n            local check = type(value)\n            if check == \"table\" then\n                tC = internalSerialize(value, tC, t)\n            elseif check == \"string\" then\n                t[tC] = sFormat(\"%q\", value)\n            elseif check == \"number\" then\n                t[tC] = value\n            elseif check == \"boolean\" then\n                t[tC] = tostring(value)\n            else\n                t[tC] = '\"Not Supported\"'\n            end\n            t[tC + 1] = \",\"\n            tC = tC + 2\n        end\n        if hasValue then\n            tC = tC - 1\n        end\n    else\n        for i = 1, #table do\n            local value = table[i]\n            local check = type(value)\n            if check == \"table\" then\n                tC = internalSerialize(value, tC, t)\n            elseif check == \"string\" then\n                t[tC] = sFormat(\"%q\", value)\n            elseif check == \"number\" then\n                t[tC] = value\n            elseif check == \"boolean\" then\n                t[tC] = tostring(value)\n            else\n                t[tC] = '\"Not Supported\"'\n            end\n            t[tC + 1] = \",\"\n            tC = tC + 2\n        end\n        tC = tC - 1\n    end\n    t[tC] = \"}\"\n    return tC\nend\n\nfunction serialize(value)\n    local t = {}\n    local check = type(value)\n\n    if check == \"table\" then\n        internalSerialize(value, 1, t)\n    elseif check == \"string\" then\n        return sFormat(\"%q\", value)\n    elseif check == \"number\" then\n        return value\n    elseif check == \"boolean\" then\n        return tostring(value)\n    else\n        return '\"Not Supported\"'\n    end\n\n    return concat(t)\nend\n\nfunction deserialize(s)\n    return load(\"return \" .. s)()\nend\n","filter":{"args":[],"signature":"onStart()","slotKey":"-5"},"key":"3"}],"methods":[],"events":[]}
